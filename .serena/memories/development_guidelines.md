# 開発ガイドライン

## 開発ワークフロー

このプロジェクトでは、標準化された開発ワークフローに従って開発を行います。詳細は`.agent/workflows/`ディレクトリ内のルールファイルを参照してください。

## 重要な原則

### 1. ADR（Architecture Decision Record）の確認
- 実装前に必ずADRを確認
- 既存のアーキテクチャ決定に従う
- 新しい決定が必要な場合は`adr-memory-manager`で記録

### 2. クリーンアーキテクチャの遵守
- レイヤー間の依存関係を一方向に保つ
- Domain Layerは外部に依存しない（純粋関数）
- 依存関係は内側から外側へのみ

### 3. 関数型プログラミング
- `fp-ts`の型（Either, Option, TaskEither）を活用
- エラーハンドリングは`Either`型を使用
- nullチェックは`Option`型を使用
- 非同期処理は`TaskEither`型を使用

### 4. 型安全性
- `any`型の使用を避ける
- 厳密な型定義を記述
- 型ガードを適切に使用

### 5. 環境変数管理
- `process.env`に直接アクセスしない
- `lib/env/env.ts`経由でのみアクセス
- Zodスキーマによる型安全な検証

## コンポーネント作成時の注意事項

### 新規コンポーネント作成時
- デモコンポーネントやドキュメント実装が必要か確認
- レジストリや設定ファイルへの登録が必要か確認
- 必要なメタデータや設定の追加が必要か確認

### テストファイルの配置
- 各モジュールと同じディレクトリに`__tests__`ディレクトリを作成
- React Component: `*.browser.spec.tsx`
- 非React Component: `*.node.spec.ts`

## コードレビューのポイント

- 既存パターンに準拠しているか
- クリーンアーキテクチャの原則に従っているか
- 型安全性が保たれているか
- テストが適切に書かれているか
- パフォーマンス上の問題がないか

## コミットメッセージ

- Conventional Commits準拠
- 日本語で記述
- `commit-message`エージェントを使用して生成

## チェンジログ

- コード変更完了後、必ずチェンジログを作成
- `change-log/{日付}/{時刻}_{変更内容}.md`形式
- 何を、どんな目的で、どう変更したかを記述