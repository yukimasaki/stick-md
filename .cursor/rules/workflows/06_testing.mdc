---
alwaysApply: true
type: rule
name: 06_testing
tags: ["testing", "stories"]
---

# Testing & Stories (テスト・ストーリー作成) 【推奨：ロジック変更時】

**使用エージェント**: test-guideline-enforcer, storybook-story-creator

**このフェーズをスキップできるケース:**

- UI/表示のみの変更でロジック変更なし
- 既存テストが十分にカバーしている場合
- ドキュメントのみの変更

## 1. Storybook ストーリー作成

- `storybook-story-creator` エージェントを使用
- **条件分岐による表示切り替えのある場合のみ**ストーリーを作成
- 単純な props 値の違いはストーリー化しない

## 2. テストコード作成

- `test-guideline-enforcer` エージェントを使用
- Vitest / React Testing Library で実装
- AAA パターン（Arrange-Act-Assert）を厳守
- 日本語のテストタイトル
- すべての条件分岐をカバー

## 3. ドキュメント・デモ実装（新規コンポーネント作成時は必須）

**⚠️ 重要: 新規コンポーネント作成時は必ず実装**

- ドキュメントサイトで動作確認できるデモコンポーネントを作成
- プロジェクト固有のデモディレクトリ構造に従って配置
- デモレジストリや設定ファイルに登録
- コンポーネントメタデータを設定ファイルに追加

**デモ実装の手順:**

1. デモコンポーネントファイルを作成（プロジェクトの命名規則に従う）
2. プロジェクト固有のデモコンポーネント（DemoSection、DemoCard など）を使用して複数の使用例を表示
3. PC/SP の動作の違いを確認できるデモを含める（該当する場合）
4. デモレジストリファイルにエントリを追加
5. コンポーネント設定ファイルにメタデータを追加（slug、name、category、description、props、codeExample など）

**完了チェックリスト:**

- [ ] 必要なストーリーを作成
- [ ] テストコードが AAA パターンに準拠
- [ ] すべての条件分岐をカバー
- [ ] テストタイトルが日本語で明確
- [ ] **新規コンポーネントの場合、Web デモを実装**（必須）
- [ ] デモがデモレジストリに登録されている
- [ ] コンポーネントが設定ファイルに登録されている
