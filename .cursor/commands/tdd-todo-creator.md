---
type: command
name: tdd-todo-creator
description: TDD原則に従った実装TODOリストを作成し、AIが自立してテスト→実装→リファクタリング→品質チェックをフェーズごとに再帰的に実行できるようにするコマンドです。
tools: Read, Edit, Write, Grep, Glob, List
model: inherit
---

# TDD TODO Creator

**役割**: 実装計画書とテスト計画書を基に、TDD（Test-Driven Development）の原則に従った詳細な TODO リストを作成します。AI が自立して各フェーズを再帰的に実行できる構造を提供します。

## いつ利用するか

- 新機能の実装や既存機能の大幅な修正を行う前に、実装 TODO リストを作成したいとき
- TDD の原則に従って、テスト → 実装 → リファクタリング → 品質チェックのサイクルを確立したいとき
- フェーズごとに段階的に実装を進めたいとき
- 実装計画書やテスト計画書が既に存在する場合

## 前提条件

### 必須ドキュメント

TODO リストを作成する前に、以下のドキュメントが存在する必要があります：

1. **実装計画書** (`implementation-plan.md`)

   - 実装要件、ディレクトリ構成、モジュール関係図
   - 各フェーズの実装詳細
   - ファイル構成、実装順序

2. **テスト計画書** (`testing-plan.md`)
   - TDD の原則に従ったテスト計画
   - 各フェーズのテストケース
   - テスト実行順序、テストカバレッジ目標

### ドキュメントがない場合

実装計画書やテスト計画書が存在しない場合は、**先にそれらの作成を促します**：

1. **実装計画書がない場合**:

   - `spec-document-creator` コマンドを使用して実装計画書を作成するよう促す
   - または、既存の実装計画書テンプレートを参照して作成を依頼

2. **テスト計画書がない場合**:
   - `spec-document-creator` コマンドを使用してテスト計画書を作成するよう促す
   - または、既存のテスト計画書テンプレートを参照して作成を依頼

## 作成フロー

### Phase 1: 前提条件の確認

1. **実装計画書の確認**

   - `docs/implementation-plans/` ディレクトリを確認
   - 実装計画書（`implementation-plan.md`）が存在するか確認
   - 存在しない場合は、作成を促す

2. **テスト計画書の確認**

   - 実装計画書と同じディレクトリ内でテスト計画書（`testing-plan.md`）を確認
   - 存在しない場合は、作成を促す

3. **ドキュメントの整合性確認**
   - 実装計画書とテスト計画書のフェーズ構成が一致しているか確認
   - 実装順序とテスト実行順序が整合しているか確認

### Phase 2: TODO リストの作成

1. **実装計画書の解析**

   - 実装順序（Phase 1, 2, 3...）を抽出
   - 各フェーズの実装要件を抽出
   - ファイル構成とディレクトリ構造を把握

2. **テスト計画書の解析**

   - 各フェーズのテストケースを抽出
   - TDD の原則（Red → Green → Refactor）を適用
   - テストファイルの配置場所を確認

3. **TODO リストの生成**
   - フェーズごとにセクションを作成
   - 各フェーズ内で以下の構造を適用:
     - 🔴 Red: テスト作成
     - 🟢 Green: 実装
     - 🔵 Refactor: リファクタリング
     - ✅ Quality Check: 品質チェック
   - チェックボックス形式でタスクを記述

### Phase 3: 出力ファイルの作成

1. **ファイル配置**

   - 実装計画書と同じディレクトリに `todo.md` を作成
   - 例: `docs/implementation-plans/{feature-name}/todo.md`

2. **ファイル構造**
   - 概要セクション（実装原則の説明）
   - 各フェーズの詳細 TODO
   - 最終確認セクション
   - 注意事項セクション
   - 関連ドキュメントへのリンク

## TODO リストの構造

### 基本構造

```markdown
# [機能名] 実装 TODO

## 概要

本ドキュメントは、[機能名] を実装するための詳細な TODO リストです。
TDD（Test-Driven Development）の原則に従い、各フェーズでテストを先に書いてから実装を進めます。

**実装原則**:

- 🔴 Red: 失敗するテストを先に書く
- 🟢 Green: テストをパスする最小限の実装
- 🔵 Refactor: リファクタリング
- ✅ Quality Check: 型チェック、リント、テスト実行

---

## Phase X: [フェーズ名]

### X.1 [サブタスク名]

#### 🔴 Red: テスト作成

- [ ] `[テストファイルパス]` を作成
  - [ ] `describe("[テストクラス名]")` テストクラスを作成
  - [ ] `it("[テストケース名]")` - [正常系/異常系]テスト
  - [ ] モック設定（[依存関係]）
  - [ ] テスト実行して失敗を確認

#### 🟢 Green: 実装

- [ ] `[実装ファイルパス]` を[作成/確認・拡張/修正]
  - [ ] `[関数名]` 関数を実装
    - [ ] [実装詳細 1]
    - [ ] [実装詳細 2]
  - [ ] テスト実行してパスを確認

#### 🔵 Refactor: リファクタリング

- [ ] テストコードの重複削減
- [ ] [その他のリファクタリング項目]

#### ✅ Quality Check

- [ ] `yarn tsc --noEmit` で型チェック
- [ ] `yarn lint` でリントエラー確認
- [ ] `yarn test:run -- [テストファイル名]` でテスト実行

---

### Phase X 完了チェック

- [ ] すべてのテストがパスしている
- [ ] 型エラーが 0 件
- [ ] リントエラーが 0 件
- [ ] Phase X のチェンジログを作成

---

## 最終確認

### 全体の品質チェック

- [ ] すべてのフェーズのテストがパスしている
- [ ] 型エラーが 0 件
- [ ] リントエラーが 0 件
- [ ] テストカバレッジが目標を達成している
- [ ] 実装計画書の要件をすべて満たしている

### チェンジログ

- [ ] 各フェーズのチェンジログを作成済み
- [ ] 最終的なチェンジログを作成

---

## 注意事項

1. **TDD 厳守**: 必ずテストを先に書く（🔴 Red → 🟢 Green → 🔵 Refactor）
2. **小さなステップ**: 各テストは 1 つの機能のみをテストする
3. **モックの適切な使用**: 外部依存はモック化
4. **品質チェック**: 各フェーズ完了時に必ず型チェック、リント、テスト実行を実施
5. **チェンジログ**: 各フェーズ完了時に必ずチェンジログを作成

---

## 関連ドキュメント

- [実装計画書](implementation-plan.md)
- [テスト計画書](testing-plan.md)
```

## 実装計画書の解析ポイント

### 抽出すべき情報

1. **実装順序**

   - Phase 1, 2, 3... の順序
   - 各フェーズの依存関係

2. **実装要件**

   - 対象ファイル（新規作成、拡張、修正）
   - 実装する関数・クラス・コンポーネント
   - 実装詳細（処理内容、エラーハンドリング）

3. **ディレクトリ構成**

   - ファイル配置場所
   - ディレクトリ構造

4. **モジュール関係**
   - 依存関係
   - データフロー

## テスト計画書の解析ポイント

### 抽出すべき情報

1. **テストケース**

   - 各フェーズのテストファイル
   - テストクラス（`describe`）
   - テストケース（`it`）
   - 正常系・異常系の分類

2. **TDD の原則**

   - Red: 失敗するテストを先に書く
   - Green: テストをパスする最小限の実装
   - Refactor: リファクタリング

3. **テスト実行順序**

   - フェーズごとの実行順序
   - 依存関係

4. **テストカバレッジ目標**
   - 各レイヤーのカバレッジ目標
   - 必須テスト項目

## チェックリスト

### 作成前

- [ ] 実装計画書が存在するか確認
- [ ] テスト計画書が存在するか確認
- [ ] 両方のドキュメントが同じディレクトリに配置されているか確認
- [ ] ドキュメントの整合性を確認

### 作成中

- [ ] 実装計画書から実装順序を抽出
- [ ] テスト計画書からテストケースを抽出
- [ ] 各フェーズの TODO を詳細に記述
- [ ] TDD の原則（Red → Green → Refactor）を適用
- [ ] 品質チェック項目を各フェーズに含める

### 作成後

- [ ] すべてのフェーズが含まれているか確認
- [ ] チェックボックスが適切に配置されているか確認
- [ ] 関連ドキュメントへのリンクが正しいか確認
- [ ] 注意事項が適切に記載されているか確認

## 使用例

### 例 1: TOS 統合機能の TODO リスト作成

```
入力:
- 実装計画書: docs/implementation-plans/03_tos-integration/implementation-plan.md
- テスト計画書: docs/implementation-plans/03_tos-integration/testing-plan.md

出力:
- TODOリスト: docs/implementation-plans/03_tos-integration/todo.md

結果:
- Phase 1: 認証方式の切り替え
- Phase 2: FieldTypeの修正
- Phase 3: 型変換ロジックの実装
- Phase 4: TOS Admin APIクライアントの実装
- Phase 5: Server Actionsの実装
- Phase 6: 統合テスト
```

### 例 2: 実装計画書がない場合

```
1. 実装計画書が存在しないことを確認
2. ユーザーに以下を促す:
   - spec-document-creator コマンドを使用して実装計画書を作成
   - または、既存の実装計画書テンプレートを参照して作成
3. 実装計画書が作成されるまで待機
4. 実装計画書が作成されたら、TODOリストの作成を再開
```

### 例 3: テスト計画書がない場合

```
1. テスト計画書が存在しないことを確認
2. ユーザーに以下を促す:
   - spec-document-creator コマンドを使用してテスト計画書を作成
   - または、既存のテスト計画書テンプレートを参照して作成
3. テスト計画書が作成されるまで待機
4. テスト計画書が作成されたら、TODOリストの作成を再開
```

## 品質保証

### TODO リストの品質基準

1. **完全性**

   - すべてのフェーズが含まれている
   - 各フェーズのすべてのタスクが記述されている

2. **明確性**

   - 各タスクが具体的に記述されている
   - ファイルパス、関数名、テストケース名が明確

3. **実行可能性**

   - チェックボックス形式で進捗管理可能
   - 各タスクが独立して実行可能

4. **整合性**
   - 実装計画書とテスト計画書の内容と一致
   - 実装順序とテスト実行順序が整合

## トラブルシューティング

### 実装計画書とテスト計画書のフェーズが一致しない場合

- 実装計画書のフェーズ構成を優先
- テスト計画書のフェーズを実装計画書に合わせて調整するよう促す

### テストケースが不足している場合

- テスト計画書に不足しているテストケースを追加するよう促す
- または、TODO リストに「テストケースの追加」タスクを含める

### 実装詳細が不明確な場合

- 実装計画書の該当セクションを確認
- 不明な点があれば、ユーザーに確認を促す

## 拡張性

### カスタマイズ可能な要素

1. **実装原則の追加**

   - プロジェクト固有の実装原則を追加可能

2. **品質チェック項目の追加**

   - プロジェクト固有の品質チェック項目を追加可能

3. **フェーズ構造のカスタマイズ**
   - プロジェクト固有のフェーズ構造に対応可能

## 関連コマンド

- `spec-document-creator`: 実装計画書・テスト計画書の作成
- `test-guideline-enforcer`: テストコードの品質保証
- `quality-check`: 品質チェックの実行

このコマンドを使用することで、TDD の原則に従った体系的な実装 TODO リストを作成し、AI が自立して各フェーズを再帰的に実行できるようになります。
